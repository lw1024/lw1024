<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>玩转文件描述符及重定向 | 鸟鸣蝉噪之地</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="

文件描述符是与某个打开的文件或数据流相关联的整数。文件描述符 0 、 1 以及 2 是系统预留的。

0 —— stdin（标准输入）
1 —— stdout（标准输出）
2 —— stderr（标准错误）

将输出文本重新定向或保存到一个文件中

echo "This is a sample text 1" > temp.txt

将文 ...">
    <link rel="preload" href="/assets/css/0.styles.67d7053b.css" as="style"><link rel="preload" href="/assets/js/app.ba44b075.js" as="script"><link rel="preload" href="/assets/js/6.0c038e8e.js" as="script"><link rel="preload" href="/assets/js/3.16414aad.js" as="script"><link rel="preload" href="/assets/js/20.5dd75c33.js" as="script"><link rel="prefetch" href="/assets/js/10.7278c7b1.js"><link rel="prefetch" href="/assets/js/11.c8213793.js"><link rel="prefetch" href="/assets/js/12.761a5be3.js"><link rel="prefetch" href="/assets/js/13.064d2cbf.js"><link rel="prefetch" href="/assets/js/14.f21054cb.js"><link rel="prefetch" href="/assets/js/15.c227b5fd.js"><link rel="prefetch" href="/assets/js/16.eeaa4a32.js"><link rel="prefetch" href="/assets/js/17.68b308cb.js"><link rel="prefetch" href="/assets/js/18.a735a9a6.js"><link rel="prefetch" href="/assets/js/19.4da9f333.js"><link rel="prefetch" href="/assets/js/21.c9d87d06.js"><link rel="prefetch" href="/assets/js/22.5485c754.js"><link rel="prefetch" href="/assets/js/23.7583ec80.js"><link rel="prefetch" href="/assets/js/24.39dfb78c.js"><link rel="prefetch" href="/assets/js/25.2c86a35e.js"><link rel="prefetch" href="/assets/js/26.e5f2a794.js"><link rel="prefetch" href="/assets/js/27.b1af5aee.js"><link rel="prefetch" href="/assets/js/28.c2e96879.js"><link rel="prefetch" href="/assets/js/29.e958fbde.js"><link rel="prefetch" href="/assets/js/30.e2e8c6ae.js"><link rel="prefetch" href="/assets/js/31.c8f35958.js"><link rel="prefetch" href="/assets/js/32.2fa3c32b.js"><link rel="prefetch" href="/assets/js/33.b7b5c92e.js"><link rel="prefetch" href="/assets/js/34.e5dacbfb.js"><link rel="prefetch" href="/assets/js/35.083b2913.js"><link rel="prefetch" href="/assets/js/36.7803079a.js"><link rel="prefetch" href="/assets/js/37.6b342d5a.js"><link rel="prefetch" href="/assets/js/38.746454dd.js"><link rel="prefetch" href="/assets/js/4.a2348c22.js"><link rel="prefetch" href="/assets/js/5.85f15384.js"><link rel="prefetch" href="/assets/js/7.a98ef5e4.js"><link rel="prefetch" href="/assets/js/8.f78f74b6.js"><link rel="prefetch" href="/assets/js/9.db9f8ed6.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.021e5da6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.67d7053b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">鸟鸣蝉噪之地 </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/tag/" class="nav-link">Tags</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">鸟鸣蝉噪之地 </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">Tags</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><div class="vuepress-blog-theme-content"><div class="content__default"><h1 id="玩转文件描述符及重定向"><a href="#玩转文件描述符及重定向" class="header-anchor">#</a> 玩转文件描述符及重定向</h1> <p><strong>文件描述符</strong>是与某个打开的文件或数据流相关联的整数。文件描述符 0 、 1 以及 2 是系统预留的。</p> <ul><li>0 —— stdin（标准输入）</li> <li>1 —— stdout（标准输出）</li> <li>2 —— stderr（标准错误）</li></ul> <h2 id="将输出文本重新定向或保存到一个文件中"><a href="#将输出文本重新定向或保存到一个文件中" class="header-anchor">#</a> 将输出文本重新定向或保存到一个文件中</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;This is a sample text 1&quot;</span> <span class="token operator">&gt;</span> temp.txt
</code></pre></div><h2 id="将文本追加到目标文件中"><a href="#将文本追加到目标文件中" class="header-anchor">#</a> 将文本追加到目标文件中</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;This is a sample text 2&quot;</span> <span class="token operator">&gt;&gt;</span> temp.txt
</code></pre></div><h2 id="标准错误"><a href="#标准错误" class="header-anchor">#</a> 标准错误</h2> <p>当命令输出错误信息时，stderr 信息就会被打印出来。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ls</span> +
<span class="token comment"># + 是一个非法参数</span>
ls: cannot access +: No such <span class="token function">file</span> or directory
</code></pre></div><blockquote><p><strong>成功和不成功的命令</strong></p> <p>当一个命令发生错误并退回时，它会返回一个非 0 的退出状态；而当命令成功完成后，它会返回数字 0。退出状态可以从特殊变量 <code>$?</code> 中获取（在命令执行后立刻运行 <code>echo $?</code>，就可以打印出退出状态）。</p></blockquote> <p>将 stderr 重定向到 out.txt：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ls</span> + <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> out.txt
</code></pre></div><p>可以将 stderr 单独重定向到一个文件，将 stdout 重定向到另一个文件：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>cmd <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>stderr.txt <span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>stdout.txt
</code></pre></div><p>还可以将 stderr 转换成 stdout，使得 stderr 和 stdout 都被重定向到同一个文件中：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>cmd <span class="token operator">&amp;&gt;</span> output.txt
</code></pre></div><h2 id="舍弃错误信息"><a href="#舍弃错误信息" class="header-anchor">#</a> 舍弃错误信息</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>cmd <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null
</code></pre></div><h2 id="既可以将数据重定向到文件，还可以提供一份重定数据的副本作为后续命令的-stdin"><a href="#既可以将数据重定向到文件，还可以提供一份重定数据的副本作为后续命令的-stdin" class="header-anchor">#</a> 既可以将数据重定向到文件，还可以提供一份重定数据的副本作为后续命令的 stdin</h2> <p>下面的代码中，tee 命令接收到来自 stdin 的数据。它将 stdout 的一份副本写入 out.txt，同时将另一份副本作为后续命令的 stdin。命令 <code>cat -n</code> 将从 stdin 中接收到的每一行数据前加上行号并写入 stdout：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">cat</span> a* <span class="token operator">|</span> <span class="token function">tee</span> out.txt <span class="token operator">|</span> <span class="token function">cat</span> -n
cat: a1: Permission denied
     <span class="token number">1</span>  a1
     <span class="token number">2</span>  a1
</code></pre></div><p><strong>注意</strong>：tee 只能从 stdin 中读取。</p> <p>默认情况下，tee 命令会将文件覆盖，但是它提供了一个 -a 选项，用于追加内容</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> a* <span class="token operator">|</span> <span class="token function">tee</span> -a out.txt <span class="token operator">|</span> <span class="token function">cat</span> -n
</code></pre></div><h2 id="将文件重定向到命令"><a href="#将文件重定向到命令" class="header-anchor">#</a> 将文件重定向到命令</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>cmd <span class="token operator">&lt;</span> <span class="token function">file</span>
</code></pre></div><h2 id="将脚本内部的文本进行重定向"><a href="#将脚本内部的文本进行重定向" class="header-anchor">#</a> 将脚本内部的文本进行重定向</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> EOF <span class="token operator">&gt;</span> log.txt
LOG FILE HEADER
This is a <span class="token builtin class-name">test</span> log <span class="token function">file</span>
Function: System statistics
EOF
</code></pre></div><p><strong>在 <code>cat &lt;&lt;EOF&gt;log.txt</code> 与下一个 EOF 行之间的所有文本行都会被当做 stdin 数据。</strong></p> <h2 id="自定义文件描述符"><a href="#自定义文件描述符" class="header-anchor">#</a> 自定义文件描述符</h2> <p>可以使用 exec 命令创建自己的文件描述符。</p> <ul><li>&lt; 操作符用于从文件中读取值 stdin （<strong>只读模式</strong>）</li> <li>&gt; 操作符用于<strong>截断模式</strong>的文件写入</li> <li>&gt;&gt; 操作符用于<strong>追加模式</strong>的文件写入</li></ul> <p>创建一个文件描述符进行文件读取：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#创建</span>
<span class="token builtin class-name">exec</span> <span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>input.txt
<span class="token comment">#使用</span>
<span class="token function">cat</span> <span class="token operator">&lt;</span><span class="token file-descriptor important">&amp;3</span>
</code></pre></div><p>创建一个文件描述符用于写入（截断模式）</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">exec</span> <span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span>output.txt
<span class="token builtin class-name">echo</span> newline <span class="token operator">&gt;</span><span class="token file-descriptor important">&amp;4</span>
</code></pre></div><p>创建一个文件描述符用于写入（追加模式）</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">exec</span> <span class="token operator"><span class="token file-descriptor important">5</span>&gt;&gt;</span>output.txt
<span class="token builtin class-name">echo</span> appended line <span class="token operator">&gt;&amp;</span>
</code></pre></div></div> <!----> <hr> <!----></div> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#将输出文本重新定向或保存到一个文件中" title="将输出文本重新定向或保存到一个文件中">将输出文本重新定向或保存到一个文件中</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#将文本追加到目标文件中" title="将文本追加到目标文件中">将文本追加到目标文件中</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#标准错误" title="标准错误">标准错误</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#舍弃错误信息" title="舍弃错误信息">舍弃错误信息</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#既可以将数据重定向到文件，还可以提供一份重定数据的副本作为后续命令的-stdin" title="既可以将数据重定向到文件，还可以提供一份重定数据的副本作为后续命令的 stdin">既可以将数据重定向到文件，还可以提供一份重定数据的副本作为后续命令的 stdin</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#将文件重定向到命令" title="将文件重定向到命令">将文件重定向到命令</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#将脚本内部的文本进行重定向" title="将脚本内部的文本进行重定向">将脚本内部的文本进行重定向</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#自定义文件描述符" title="自定义文件描述符">自定义文件描述符</a></div></div></div></div> <footer class="footer" data-v-582f9766><div class="footer-left-wrap" data-v-582f9766><ul class="contact" data-v-582f9766><li class="contact-item" data-v-582f9766><a href="https://github.com/lw1024" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-582f9766><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-582f9766></path></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-582f9766><ul class="copyright" data-v-582f9766><li class="copyright-item" data-v-582f9766><a href="http://beian.miit.gov.cn" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766>苏ICP备18061680号</a></li><li class="copyright-item" data-v-582f9766><a href="/" class="nav-link" data-v-582f9766>Copyright © 2020 Luwei</a></li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ba44b075.js" defer></script><script src="/assets/js/6.0c038e8e.js" defer></script><script src="/assets/js/3.16414aad.js" defer></script><script src="/assets/js/20.5dd75c33.js" defer></script>
  </body>
</html>

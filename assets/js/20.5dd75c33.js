(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{365:function(s,t,a){"use strict";a.r(t);var e=a(7),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"玩转文件描述符及重定向"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#玩转文件描述符及重定向"}},[s._v("#")]),s._v(" 玩转文件描述符及重定向")]),s._v(" "),a("p",[a("strong",[s._v("文件描述符")]),s._v("是与某个打开的文件或数据流相关联的整数。文件描述符 0 、 1 以及 2 是系统预留的。")]),s._v(" "),a("ul",[a("li",[s._v("0 —— stdin（标准输入）")]),s._v(" "),a("li",[s._v("1 —— stdout（标准输出）")]),s._v(" "),a("li",[s._v("2 —— stderr（标准错误）")])]),s._v(" "),a("h2",{attrs:{id:"将输出文本重新定向或保存到一个文件中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将输出文本重新定向或保存到一个文件中"}},[s._v("#")]),s._v(" 将输出文本重新定向或保存到一个文件中")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"This is a sample text 1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" temp.txt\n")])])]),a("h2",{attrs:{id:"将文本追加到目标文件中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将文本追加到目标文件中"}},[s._v("#")]),s._v(" 将文本追加到目标文件中")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"This is a sample text 2"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" temp.txt\n")])])]),a("h2",{attrs:{id:"标准错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#标准错误"}},[s._v("#")]),s._v(" 标准错误")]),s._v(" "),a("p",[s._v("当命令输出错误信息时，stderr 信息就会被打印出来。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" +\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# + 是一个非法参数")]),s._v("\nls: cannot access +: No such "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" or directory\n")])])]),a("blockquote",[a("p",[a("strong",[s._v("成功和不成功的命令")])]),s._v(" "),a("p",[s._v("当一个命令发生错误并退回时，它会返回一个非 0 的退出状态；而当命令成功完成后，它会返回数字 0。退出状态可以从特殊变量 "),a("code",[s._v("$?")]),s._v(" 中获取（在命令执行后立刻运行 "),a("code",[s._v("echo $?")]),s._v("，就可以打印出退出状态）。")])]),s._v(" "),a("p",[s._v("将 stderr 重定向到 out.txt：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" + "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v(" out.txt\n")])])]),a("p",[s._v("可以将 stderr 单独重定向到一个文件，将 stdout 重定向到另一个文件：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("cmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v("stderr.txt "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("1")]),s._v(">")]),s._v("stdout.txt\n")])])]),a("p",[s._v("还可以将 stderr 转换成 stdout，使得 stderr 和 stdout 都被重定向到同一个文件中：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("cmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&>")]),s._v(" output.txt\n")])])]),a("h2",{attrs:{id:"舍弃错误信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#舍弃错误信息"}},[s._v("#")]),s._v(" 舍弃错误信息")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("cmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v("/dev/null\n")])])]),a("h2",{attrs:{id:"既可以将数据重定向到文件，还可以提供一份重定数据的副本作为后续命令的-stdin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#既可以将数据重定向到文件，还可以提供一份重定数据的副本作为后续命令的-stdin"}},[s._v("#")]),s._v(" 既可以将数据重定向到文件，还可以提供一份重定数据的副本作为后续命令的 stdin")]),s._v(" "),a("p",[s._v("下面的代码中，tee 命令接收到来自 stdin 的数据。它将 stdout 的一份副本写入 out.txt，同时将另一份副本作为后续命令的 stdin。命令 "),a("code",[s._v("cat -n")]),s._v(" 将从 stdin 中接收到的每一行数据前加上行号并写入 stdout：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" a* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" out.txt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" -n\ncat: a1: Permission denied\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  a1\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("  a1\n")])])]),a("p",[a("strong",[s._v("注意")]),s._v("：tee 只能从 stdin 中读取。")]),s._v(" "),a("p",[s._v("默认情况下，tee 命令会将文件覆盖，但是它提供了一个 -a 选项，用于追加内容")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" a* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" -a out.txt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" -n\n")])])]),a("h2",{attrs:{id:"将文件重定向到命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将文件重定向到命令"}},[s._v("#")]),s._v(" 将文件重定向到命令")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("cmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n")])])]),a("h2",{attrs:{id:"将脚本内部的文本进行重定向"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将脚本内部的文本进行重定向"}},[s._v("#")]),s._v(" 将脚本内部的文本进行重定向")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" EOF "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" log.txt\nLOG FILE HEADER\nThis is a "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" log "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\nFunction: System statistics\nEOF\n")])])]),a("p",[a("strong",[s._v("在 "),a("code",[s._v("cat <<EOF>log.txt")]),s._v(" 与下一个 EOF 行之间的所有文本行都会被当做 stdin 数据。")])]),s._v(" "),a("h2",{attrs:{id:"自定义文件描述符"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义文件描述符"}},[s._v("#")]),s._v(" 自定义文件描述符")]),s._v(" "),a("p",[s._v("可以使用 exec 命令创建自己的文件描述符。")]),s._v(" "),a("ul",[a("li",[s._v("< 操作符用于从文件中读取值 stdin （"),a("strong",[s._v("只读模式")]),s._v("）")]),s._v(" "),a("li",[s._v("> 操作符用于"),a("strong",[s._v("截断模式")]),s._v("的文件写入")]),s._v(" "),a("li",[s._v(">> 操作符用于"),a("strong",[s._v("追加模式")]),s._v("的文件写入")])]),s._v(" "),a("p",[s._v("创建一个文件描述符进行文件读取：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("3")]),s._v("<")]),s._v("input.txt\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&3")]),s._v("\n")])])]),a("p",[s._v("创建一个文件描述符用于写入（截断模式）")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("4")]),s._v(">")]),s._v("output.txt\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" newline "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&4")]),s._v("\n")])])]),a("p",[s._v("创建一个文件描述符用于写入（追加模式）")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("5")]),s._v(">>")]),s._v("output.txt\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" appended line "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">&")]),s._v("\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);